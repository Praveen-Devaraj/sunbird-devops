#!/bin/bash
# Title: Configuring  Support dynamic form api
# Description: Technical document on configuring Support dynamic form api
# Note: Dependencies Install jq before running this script

sunbirdBaseURL="https://preprod.ntp.net.in"
Bearer="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI2N2I5NTQ1Y2I2YzY0NTViOTE5NDcyMzhjYWZmMGRiNyJ9.ICzasPpPeu5-PGcRWBKtJ4TYXubKlbyMzdLgVBLD0GE"


### Set The Support dynamic form api

curl -i -X POST \
  $sunbirdBaseURL/api/data/v1/form/create \
  -H "Authorization: Bearer $Bearer" \
  -H 'Content-Type: application/json' \
  -d '{"request":{"type":"dynamicform","subType":"support_v2","action":"get","rootOrgId":"*","component":"app","data":{"templateName":"support_v2","action":"get","fields":[{"code":"category","type":"nested_select","templateOptions":{"placeHolder":"Select Category","multiple":false,"hidden":false,"options":[{"value":"content","label":"Content"},{"value":"loginRegistration","label":"Login/Registration"},{"value":"teacherTraining","label":"Teacher Training"},{"value":"otherissues","label":"Other Issues","dataSrc":{"action":"initiateEmail"}}]},"validations":[{"type":"required"}],"children":{"otherissues":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}]}},{"code":"subcategory","context":"category","type":"nested_select","children":{"contentquality":[{"code":"board","type":"select","templateOptions":{"placeHolder":"Select Board","multiple":false,"dataSrc":{"marker":"ACTIVE_CHANNEL.SUGGESTED_FRAMEWORK_LIST.MAPPED_TO_FRAMEWORKCATEGORIES"}},"validations":[{"type":"required"}]},{"code":"medium","type":"nested_select","context":"board","default":null,"templateOptions":{"placeHolder":"Select Medium","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"medium"}}},"validations":[{"type":"required"}]},{"code":"grade","type":"nested_select","context":"medium","templateOptions":{"placeHolder":"Select Grade","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"grade"}}},"validations":[{"type":"required"}]},{"code":"subject","type":"nested_select","context":"grade","templateOptions":{"placeHolder":"Select Subject","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"subject"}}},"validations":[{"type":"required"}]},{"code":"contentname","type":"input","context":null,"templateOptions":{"placeHolder":"Enter Content Name"},"validations":[{"type":"required"}]},{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"contentnotplaying":[{"code":"board","type":"select","templateOptions":{"placeHolder":"Select Board","multiple":false,"dataSrc":{"marker":"ACTIVE_CHANNEL.SUGGESTED_FRAMEWORK_LIST.MAPPED_TO_FRAMEWORKCATEGORIES"}},"validations":[{"type":"required"}]},{"code":"medium","type":"nested_select","context":"board","default":null,"templateOptions":{"placeHolder":"Select Medium","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"medium"}}},"validations":[{"type":"required"}]},{"code":"grade","type":"nested_select","context":"medium","templateOptions":{"placeHolder":"Select Grade","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"grade"}}},"validations":[{"type":"required"}]},{"code":"subject","type":"nested_select","context":"grade","templateOptions":{"placeHolder":"Select Subject","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"subject"}}},"validations":[{"type":"required"}]},{"code":"contentname","type":"input","context":null,"templateOptions":{"placeHolder":"Enter Content Name"},"validations":[{"type":"required"}]},{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"contentavailability":[{"code":"board","type":"select","templateOptions":{"placeHolder":"Select Board","multiple":false,"dataSrc":{"marker":"ACTIVE_CHANNEL.SUGGESTED_FRAMEWORK_LIST.MAPPED_TO_FRAMEWORKCATEGORIES","params":{"relevantTerms":["CBSE"]}}},"validations":[{"type":"required"}]},{"code":"medium","type":"nested_select","context":"board","default":null,"templateOptions":{"placeHolder":"Select Medium","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"medium"}}},"validations":[{"type":"required"}]},{"code":"grade","type":"nested_select","context":"medium","templateOptions":{"placeHolder":"Select Grade","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"grade"}}},"validations":[{"type":"required"}]},{"code":"subject","type":"nested_select","context":"grade","templateOptions":{"placeHolder":"Select Subject","multiple":true,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"subject"}}},"validations":[{"type":"required"}]},{"code":"contenttype","type":"select","templateOptions":{"placeHolder":"Select Content Type","multiple":false,"options":[{"value":"digitextbbok","label":"Digital Textbook"},{"value":"course","label":"Course"},{"value":"tvlesson","label":"TV Lesson"},{"value":"explaincontent","label":"Explanation content"},{"value":"practiceques","label":"Practice Questions"},{"value":"quiz","label":"Quiz"}]},"validations":[{"type":"required"}]},{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]},{"code":"notify","type":"checkbox","templateOptions":{"label":"Notify me on availability"}}],"contentotherissues":[{"code":"board","type":"select","templateOptions":{"placeHolder":"Select Board","multiple":false,"dataSrc":{"marker":"ACTIVE_CHANNEL.SUGGESTED_FRAMEWORK_LIST.MAPPED_TO_FRAMEWORKCATEGORIES"}},"validations":[{"type":"required"}]},{"code":"medium","type":"nested_select","context":"board","default":null,"templateOptions":{"placeHolder":"Select Medium","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"medium"}}},"validations":[{"type":"required"}]},{"code":"grade","type":"nested_select","context":"medium","templateOptions":{"placeHolder":"Select Grade","multiple":false,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"grade"}}},"validations":[{"type":"required"}]},{"code":"subject","type":"nested_select","context":"grade","templateOptions":{"placeHolder":"Select Subject","multiple":true,"dataSrc":{"marker":"FRAMEWORK_CATEGORY_TERMS","params":{"categoryCode":"subject"}}},"validations":[{"type":"required"}]},{"code":"contentname","type":"input","context":null,"templateOptions":{"placeHolder":"Enter Content Name"},"validations":[{"type":"required"}]},{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"otpissue":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"profilevalidation":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"profiledetails":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"certificate":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"teacherid":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"profileotherissues":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}],"teacherotherissues":[{"code":"details","type":"textarea","context":null,"templateOptions":{"label":"Tell us more","placeHolder":"Enter Details"},"validations":[{"type":"maxLength","value":1000}]}]},"templateOptions":{"placeHolder":"Select Subcategory","multiple":false,"hidden":false,"options":{"loginRegistration":[{"value":"otpissue","label":"OTP Issue","dataSrc":{"action":"initiateEmail"}},{"value":"profilevalidation","label":"Profile validation/No green tick on my profile","dataSrc":{"action":"contactBoard"}},{"value":"profiledetails","label":"Profile details incorrect","dataSrc":{"action":"contactBoard"}},{"value":"certificate","label":"Certificate related","dataSrc":{"action":"contactBoard"}},{"value":"teacherid","label":"Teacher id","dataSrc":{"action":"contactBoard"}},{"value":"profileotherissues","label":"Other issues","dataSrc":{"action":"contactBoard"}}],"content":[{"value":"contentquality","label":"Content Quality","dataSrc":{"action":"initiateEmail"}},{"value":"contentnotplaying","label":"Content not playing/downloading","dataSrc":{"action":"initiateEmail"}},{"value":"contentavailability","label":"Content availability","dataSrc":{"action":"initiateEmail"}},{"value":"contentotherissues","label":"Other Issues","dataSrc":{"action":"initiateEmail"}}],"teacherTraining":[{"value":"profilevalidation","label":"Profile validation/No green tick on my profile","dataSrc":{"action":"contactBoard"}},{"value":"profiledetails","label":"Profile details incorrect","dataSrc":{"action":"contactBoard"}},{"value":"certificate","label":"Certificate related","dataSrc":{"action":"contactBoard"}},{"value":"teacherotherissues","label":"Other issues","dataSrc":{"action":"contactBoard"}}]}}}]}}}' 

# Check the status of Support dynamic  form api

curl -s -X POST \
   $sunbirdBaseURL/api/data/v1/form/read \
  -H "Authorization: Bearer $Bearer" \
  -H 'Content-Type: application/json' \
  -d '{
  "request": {
    "type": "dynamicform",
    "subType": "support_v2",
    "action": "get",
    "component": "app"
  }
}'
